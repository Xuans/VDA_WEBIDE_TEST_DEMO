{"remainingRequest":"/Users/lijiancheng/Agree/Vue0815/node_modules/babel-loader/lib/index.js!/Users/lijiancheng/Agree/Vue0815/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lijiancheng/Agree/Vue0815/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lijiancheng/Agree/Vue0815/src/views/global/roleList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lijiancheng/Agree/Vue0815/src/views/global/roleList.vue","mtime":1565848515399},{"path":"/Users/lijiancheng/Agree/Vue0815/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lijiancheng/Agree/Vue0815/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lijiancheng/Agree/Vue0815/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lijiancheng/Agree/Vue0815/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getUserListPage, removeUser, editUser, addUser } from \"../../api/api.js\";\nimport { mixins } from '@v2-lib/vue.spa.plugin';\nexport default {\n  mixins: [mixins],\n  data: function data() {\n    return {\n      searchForm: {\n        roleId: \"\",\n        roleName: \"\",\n        createUser: \"\"\n      },\n      checkedMenu: [],\n      isSingle: true,\n      isDubble: true,\n      roleList: [],\n      totalRole: 0,\n      rolePage: 1,\n      pageSize: 10,\n      listLoading: false,\n      selectedRoleList: [],\n      //列表选中列\n      editRoleVisible: false,\n      //编辑界面是否显示\n      editLoading: false,\n      editFormRules: {\n        name: [{\n          required: true,\n          message: \"请输入角色名\",\n          trigger: \"blur\"\n        }],\n        remark: [{\n          required: true,\n          message: \"请输入备注\",\n          trigger: \"blur\"\n        }]\n      },\n      //编辑界面数据\n      editForm: {\n        name: \"\",\n        remark: \"\"\n      },\n      addRoleVisible: false,\n      //新增界面是否显示\n      addLoading: false,\n      addFormRules: {\n        name: [{\n          required: true,\n          message: \"请输入角色名\",\n          trigger: \"blur\"\n        }],\n        remark: [{\n          required: true,\n          message: \"请输入备注\",\n          trigger: \"blur\"\n        }]\n      },\n      //新增界面数据\n      addForm: {\n        name: \"\",\n        remark: \"\"\n      },\n      levelModalVisible: false,\n      roleMenuTree: [],\n      defaultProps: {\n        children: \"children\",\n        label: \"name\"\n      },\n      checekdTreeNodes: []\n    };\n  },\n  props: {\n    params: String //父组件传过来的参数\n\n  },\n  methods: {\n    getPageRole: function getPageRole(val) {\n      this.rolePage = val;\n      this.getRoleList();\n    },\n    searchRoleList: function searchRoleList() {\n      this.rolePage = 1;\n      this.getRoleList();\n    },\n    //获取角色列表\n    getRoleList: function getRoleList() {\n      var _this = this;\n\n      this.listLoading = true;\n      this.$get(\"\".concat(this.$axios.server, \"/springmvc/role/listAllRoles\"), {\n        createUser: this.searchForm.createUser,\n        roleName: this.searchForm.roleName,\n        roleId: this.searchForm.roleId,\n        pageNum: this.rolePage,\n        pageSize: this.pageSize\n      }).then(function (data) {\n        var roleList = data && data.content && data.content.data && data.content.data.roleList || [];\n        _this.totalRole = data && data.content && data.content.data && data.content.data.totle || 0;\n\n        if (data.status) {\n          if (roleList) {\n            for (var i = 0; i < roleList.length; i++) {\n              roleList[i].createTime = _this.formatTime(roleList[i].createTime);\n            }\n\n            _this.roleList = roleList;\n          }\n        } else {}\n      });\n      this.listLoading = false;\n    },\n    //重置\n    resetForm: function resetForm() {\n      this.searchForm.roleId = \"\";\n      this.searchForm.roleName = \"\";\n      this.searchForm.createUser = \"\";\n      this.rolePage = 1;\n      this.getRoleList();\n    },\n    //删除角色\n    delRole: function delRole() {\n      var _this2 = this;\n\n      var roleIds = [];\n\n      var _this = this;\n\n      for (var i = 0; i < this.selectedRoleList.length; i++) {\n        roleIds.push(this.selectedRoleList[i].roleId);\n      }\n\n      this.$confirm(\"确认删除该角色吗?\", \"删除角色\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        _this2.$deleteAxios(\"\".concat(_this2.$axios.server, \"/springmvc/role/deleteRole\"), {\n          roleIds: roleIds.join()\n        }).then(function (data) {\n          if (data.status) {\n            _this.$notify({\n              title: \"删除角色成功\",\n              type: \"success\"\n            });\n\n            _this.resetForm();\n          } else {\n            this.$notify({\n              title: data.errorMsg,\n              type: \"success\"\n            });\n          }\n        }).catch(function (err) {\n          _this.$notify({\n            title: err,\n            type: \"error\"\n          });\n        });\n      });\n    },\n    showEditRoleModal: function showEditRoleModal() {\n      this.editRoleVisible = true;\n      this.editForm.name = this.selectedRoleList[0].roleName;\n      this.editForm.remark = this.selectedRoleList[0].remark;\n    },\n    //编辑\n    surEditRole: function surEditRole() {\n      var _this3 = this;\n\n      this.$refs.editForm.validate(function (valid) {\n        if (valid) {\n          _this3.addLoading = true;\n          var params = {};\n          params.roleId = _this3.selectedRoleList[0].roleId;\n          params.roleName = _this3.editForm.name;\n          params.remark = _this3.editForm.remark;\n\n          _this3.$putAxios(\"\".concat(_this3.$axios.server, \"/springmvc/role/editRole\"), params).then(function (res) {\n            _this3.addLoading = false;\n\n            if (res.status) {\n              _this3.$notify({\n                title: \"修改角色成功\",\n                type: \"success\"\n              });\n\n              _this3.editRoleVisible = false;\n\n              _this3.getRoleList();\n            } else {\n              _this3.$notify({\n                title: \"修改角色失败\",\n                type: \"error\"\n              });\n            }\n          });\n        }\n      });\n    },\n    //新增角色\n    surAddRole: function surAddRole() {\n      var _this4 = this;\n\n      var _this = this;\n\n      this.$refs.addForm.validate(function (valid) {\n        if (valid) {\n          _this4.addLoading = true;\n          var params = {};\n          params.roleName = _this4.addForm.name;\n          params.remark = _this4.addForm.remark;\n\n          _this4.$post(\"\".concat(_this4.$axios.server, \"/springmvc/role/addRole\"), params).then(function (res) {\n            _this.addLoading = false;\n\n            if (res.status) {\n              _this4.$notify({\n                title: \"创建角色成功\",\n                type: \"success\"\n              });\n\n              _this4.$refs[\"addForm\"].resetFields();\n\n              _this4.addRoleVisible = false;\n\n              _this4.resetForm();\n            } else {\n              _this4.$notify({\n                title: \"创建角色失败\",\n                message: res.errorMsg,\n                type: \"error\"\n              });\n            }\n          });\n        }\n      });\n    },\n    selectRole: function selectRole(sels) {\n      this.selectedRoleList = sels || {};\n\n      if (sels.length > 1) {\n        this.isDubble = false;\n        this.isSingle = true;\n      } else if (sels.length === 1) {\n        this.isDubble = false;\n        this.isSingle = false;\n      } else {\n        this.isDubble = true;\n        this.isSingle = true;\n      }\n    },\n    getRoleMenu: function getRoleMenu() {\n      var _this = this;\n\n      var menus = [],\n          menuObj = {},\n          menuParent = {},\n          result = [];\n      _this.checekdTreeNodes = [];\n      _this.checkedMenu = [];\n      this.$get(\"\".concat(this.$axios.server, \"/springmvc/role/listAllMenus.do\"), {\n        roleId: _this.selectedRoleList[0].roleId\n      }).then(function (res) {\n        if (res.status) {\n          result = res && res.content && res.content.treeDatas || [];\n\n          if (result.length) {\n            menus = result.map(function (item, idx) {\n              item.pId && (menuParent[item.pId] = 1);\n              item.id = item.id ? item.id : item.accCode ? item.pId + item.accCode : item.pId + idx;\n              item.pid = item.pId;\n\n              if (item.checked === \"true\" && item.accCode) {\n                _this.checekdTreeNodes.push(item);\n\n                _this.checkedMenu.push(item.id);\n              }\n\n              return item;\n            });\n            menus.map(function (i) {\n              !i.pid && (i.pid = '');\n              var p = menuObj[i.pid];\n\n              if (!p) {\n                p = menuObj[i.pid] = {\n                  id: i.pid,\n                  disabled: true,\n                  children: []\n                };\n              } else {\n                !p.children && (p.children = []);\n                p.disabled = true;\n              }\n\n              var item = menuObj[i.id] || {\n                id: i.id\n              };\n              item.name = i.name;\n              item.pid = i.pid;\n              item.checked = i.checked;\n              i.accCode && (item.accCode = i.accCode);\n              item.type = i.type;\n              i.open && (item.open = i.open);\n              menuObj[i.id] = item;\n              p.children.push(item);\n            });\n            Object.keys(menuObj).filter(function (e) {\n              return !menuObj[e].children;\n            }).map(function (e) {\n              return delete menuObj[e];\n            });\n            _this.roleMenuTree = menuObj[''].children;\n          }\n        }\n      });\n    },\n    selectedMenuTree: function selectedMenuTree(data, ischeck, target) {\n      var oldCheckedTree = this.checekdTreeNodes,\n          flag = true;\n\n      if (data.accCode) {\n        if (ischeck) {\n          for (var i = 0; i < oldCheckedTree.length; i++) {\n            var item = oldCheckedTree[i];\n\n            if (item.pid === data.pid) {\n              this.checekdTreeNodes.splice(i, 1, data);\n              this.$refs.roleMenuTree.setCheckedNodes(this.checekdTreeNodes);\n              flag = false;\n            }\n          }\n\n          if (flag) {\n            this.checekdTreeNodes = this.$refs.roleMenuTree.getCheckedNodes();\n          }\n        } else {\n          this.checekdTreeNodes = this.$refs.roleMenuTree.getCheckedNodes();\n        }\n      }\n    },\n    showLevelModal: function showLevelModal() {\n      this.getRoleMenu();\n      this.levelModalVisible = true;\n    },\n    //关联权限\n    associateLevel: function associateLevel() {\n      var _this5 = this;\n\n      var checkedNodes = this.$refs.roleMenuTree.getCheckedNodes(),\n          parentNodes = this.$refs.roleMenuTree.getHalfCheckedNodes(),\n          accessIds = [],\n          parentObj = {};\n\n      for (var i = 0; i < checkedNodes.length; i++) {\n        var item = checkedNodes[i],\n            str = item.pid + \"=\" + item.accCode;\n        parentObj[item.pid] = 1;\n        accessIds.push(str);\n      }\n\n      for (var _i = 0; _i < parentNodes.length; _i++) {\n        var item = parentNodes[_i],\n            str = item.id + \"=PARENT_NODE\";\n\n        if (!parentObj[item.id]) {\n          accessIds.push(str);\n        }\n      }\n\n      this.$putAxios(\"\".concat(this.$axios.server, \"/springmvc/role/relevanceAccess\"), {\n        roleId: this.selectedRoleList[0].roleId,\n        accessIds: accessIds.join()\n      }).then(function (res) {\n        if (res.status) {\n          _this5.$notify({\n            title: \"关联权限成功\",\n            type: \"success\"\n          });\n\n          _this5.levelModalVisible = false;\n        } else {\n          _this5.$notify({\n            title: \"关联权限失败\",\n            message: res.errorMsg,\n            type: \"error\"\n          });\n        }\n      });\n    },\n    formatTime: function formatTime(data) {\n      var date = data && new Date(data);\n\n      if (data && date) {\n        return date.getFullYear() + \"-\" + (date.getMonth() + 1 > 9 ? date.getMonth() + 1 : \"0\" + (date.getMonth() + 1)) + \"-\" + (date.getDate() > 9 ? date.getDate() : \"0\" + date.getDate()) + \" \" + (date.getHours() > 9 ? date.getHours() : \"0\" + date.getHours()) + \":\" + (date.getMinutes() > 9 ? date.getMinutes() : \"0\" + date.getMinutes()) + \":\" + (date.getSeconds() > 9 ? date.getSeconds() : \"0\" + date.getSeconds());\n      } else {\n        return \"\";\n      }\n    }\n  },\n  mounted: function mounted() {\n    this.getRoleList();\n    console.log(\"刷新表格页面,参数\", this.params);\n  },\n  resume: function resume() {\n    console.log(\"表格页面resume\");\n  },\n  pause: function pause() {\n    console.log(\"表格页面pause\");\n  }\n};",{"version":3,"sources":["roleList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <section>\r\n    <!--工具条-->\r\n    <el-col :span=\"24\" class=\"aweb-table-toolbar\" style=\"padding-bottom: 0px;\">\r\n      <el-form :inline=\"true\" :model=\"searchForm\" size=\"mini\">\r\n        <el-form-item label=\"角色ID\">\r\n          <el-input v-model=\"searchForm.roleId\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"角色名\">\r\n          <el-input v-model=\"searchForm.roleName\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"创建用户\">\r\n          <el-input v-model=\"searchForm.createUser\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <el-form size=\"mini\">\r\n        <el-form-item>\r\n          <el-button type=\"primary\" v-on:click=\"searchRoleList\">查询</el-button>\r\n          <el-button type=\"primary\" @click=\"resetForm\">重置</el-button>\r\n          <el-button type=\"primary\" v-on:click=\"addRoleVisible = true\">新建</el-button>\r\n          <el-button type=\"primary\" @click=\"showEditRoleModal\" :disabled=\"isSingle\">修改</el-button>\r\n          <el-button type=\"primary\" v-on:click=\"delRole\" :disabled=\"isDubble\">删除</el-button>\r\n          <el-button type=\"primary\" @click=\"showLevelModal\" :disabled=\"isSingle\">关联权限</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-col>\r\n\r\n    <!--列表-->\r\n    <el-table\r\n      :data=\"roleList\"\r\n      v-loading=\"listLoading\"\r\n      @selection-change=\"selectRole\"\r\n      style=\"width: 100%;\"\r\n      max-height=\"500\"\r\n    >\r\n      <el-table-column type=\"selection\" width=\"55\"></el-table-column>\r\n      <el-table-column type=\"index\" width=\"60\"></el-table-column>\r\n      <el-table-column prop=\"roleId\" label=\"角色ID\" width=\"120\" sortable></el-table-column>\r\n      <el-table-column prop=\"roleName\" label=\"角色名\" width=\"120\" sortable></el-table-column>\r\n      <el-table-column prop=\"createUser\" label=\"创建用户\" width=\"120\" sortable></el-table-column>\r\n      <el-table-column prop=\"createTime\" label=\"创建时间\" min-width=\"120\" sortable></el-table-column>\r\n      <el-table-column prop=\"updateTime\" label=\"更新时间\" min-width=\"120\" sortable></el-table-column>\r\n      <el-table-column prop=\"remark\" label=\"备注\" min-width=\"180\" sortable></el-table-column>\r\n    </el-table>\r\n\r\n    <!--工具条-->\r\n    <el-col :span=\"24\" class=\"aweb-table-toolbar\">\r\n      <el-pagination\r\n        layout=\"prev, pager, next\"\r\n        @current-change=\"getPageRole\"\r\n        :page-size=\"pageSize\"\r\n        :total=\"totalRole\"\r\n        style=\"float:right;\"\r\n      ></el-pagination>\r\n    </el-col>\r\n\r\n    <!--新增界面-->\r\n    <el-dialog title=\"新增角色\" :visible.sync=\"addRoleVisible\" :close-on-click-modal=\"false\">\r\n      <el-form :model=\"addForm\" label-width=\"80px\" :rules=\"addFormRules\" ref=\"addForm\" size=\"mini\">\r\n        <el-form-item label=\"角色名\" prop=\"name\">\r\n          <el-input v-model=\"addForm.name\" auto-complete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\" prop=\"remark\">\r\n          <el-input v-model=\"addForm.remark\" auto-complete=\"off\" type=\"textarea\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click.native=\"surAddRole\" :loading=\"addLoading\">确认</el-button>\r\n        <el-button @click.native=\"addRoleVisible = false\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!--编辑界面-->\r\n    <el-dialog title=\"编辑角色\" :visible.sync=\"editRoleVisible\" :close-on-click-modal=\"false\">\r\n      <el-form\r\n        :model=\"editForm\"\r\n        label-width=\"80px\"\r\n        :rules=\"editFormRules\"\r\n        ref=\"editForm\"\r\n        size=\"mini\"\r\n      >\r\n        <el-form-item label=\"角色名\" prop=\"name\">\r\n          <el-input v-model=\"editForm.name\" auto-complete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"备注\" prop=\"remark\">\r\n          <el-input v-model=\"editForm.remark\" auto-complete=\"off\" type=\"textarea\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click.native=\"surEditRole\" :loading=\"editLoading\">确认</el-button>\r\n        <el-button @click.native=\"editRoleVisible = false\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!--关联权限-->\r\n    <el-dialog title=\"配置角色\" :visible.sync=\"levelModalVisible\" :close-on-click-modal=\"false\">\r\n      <div class=\"role-tree-wrap\">\r\n        <el-tree\r\n          :data=\"roleMenuTree\"\r\n          show-checkbox\r\n          default-expand-all\r\n          node-key=\"id\"\r\n          ref=\"roleMenuTree\"\r\n          highlight-current\r\n          :props=\"defaultProps\"\r\n          @check-change=\"selectedMenuTree\"\r\n          :default-checked-keys=\"checkedMenu\"\r\n          style=\"max-height:500px;overflow:auto;\"\r\n        ></el-tree>\r\n      </div>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click.native=\"associateLevel\" :loading=\"addLoading\">确认</el-button>\r\n        <el-button @click.native=\"levelModalVisible = false\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getUserListPage,\r\n  removeUser,\r\n  editUser,\r\n  addUser\r\n} from \"../../api/api.js\";\r\n\r\nimport  {mixins} from '@v2-lib/vue.spa.plugin';\r\nexport default {\r\n  mixins:[mixins],\r\n  data() {\r\n    return {\r\n      searchForm: {\r\n        roleId: \"\",\r\n        roleName: \"\",\r\n        createUser: \"\"\r\n      },\r\n      checkedMenu: [],\r\n      isSingle: true,\r\n      isDubble: true,\r\n      roleList: [],\r\n      totalRole: 0,\r\n      rolePage: 1,\r\n      pageSize: 10,\r\n      listLoading: false,\r\n      selectedRoleList: [], //列表选中列\r\n\r\n      editRoleVisible: false, //编辑界面是否显示\r\n      editLoading: false,\r\n      editFormRules: {\r\n        name: [{ required: true, message: \"请输入角色名\", trigger: \"blur\" }],\r\n        remark: [{ required: true, message: \"请输入备注\", trigger: \"blur\" }]\r\n      },\r\n      //编辑界面数据\r\n      editForm: {\r\n        name: \"\",\r\n        remark: \"\"\r\n      },\r\n\r\n      addRoleVisible: false, //新增界面是否显示\r\n      addLoading: false,\r\n      addFormRules: {\r\n        name: [{ required: true, message: \"请输入角色名\", trigger: \"blur\" }],\r\n        remark: [{ required: true, message: \"请输入备注\", trigger: \"blur\" }]\r\n      },\r\n      //新增界面数据\r\n      addForm: {\r\n        name: \"\",\r\n        remark: \"\"\r\n      },\r\n\r\n      levelModalVisible: false,\r\n      roleMenuTree: [],\r\n      defaultProps: {\r\n        children: \"children\",\r\n        label: \"name\"\r\n      },\r\n      checekdTreeNodes: []\r\n    };\r\n  },\r\n  props: {\r\n    params: String //父组件传过来的参数\r\n  },\r\n  methods: {\r\n    getPageRole(val) {\r\n      this.rolePage = val;\r\n      this.getRoleList();\r\n    },\r\n    searchRoleList: function() {\r\n      this.rolePage = 1;\r\n      this.getRoleList();\r\n    },\r\n    //获取角色列表\r\n    getRoleList() {\r\n      var _this = this;\r\n      this.listLoading = true;\r\n      this.$get(`${this.$axios.server}/springmvc/role/listAllRoles`, {\r\n        createUser: this.searchForm.createUser,\r\n        roleName: this.searchForm.roleName,\r\n        roleId: this.searchForm.roleId,\r\n        pageNum: this.rolePage,\r\n        pageSize: this.pageSize\r\n      }).then(function(data) {\r\n        var roleList =\r\n          (data &&\r\n            data.content &&\r\n            data.content.data &&\r\n            data.content.data.roleList) ||\r\n          [];\r\n        _this.totalRole =\r\n          (data &&\r\n            data.content &&\r\n            data.content.data &&\r\n            data.content.data.totle) ||\r\n          0;\r\n\r\n        if (data.status) {\r\n          if (roleList) {\r\n            for (let i = 0; i < roleList.length; i++) {\r\n              roleList[i].createTime = _this.formatTime(roleList[i].createTime);\r\n            }\r\n            _this.roleList = roleList;\r\n          }\r\n        } else {\r\n        }\r\n      });\r\n      this.listLoading = false;\r\n    },\r\n\r\n    //重置\r\n    resetForm() {\r\n      this.searchForm.roleId = \"\";\r\n      this.searchForm.roleName = \"\";\r\n      this.searchForm.createUser = \"\";\r\n      this.rolePage = 1;\r\n      this.getRoleList();\r\n    },\r\n\r\n    //删除角色\r\n    delRole: function() {\r\n      var roleIds = [];\r\n      var _this = this;\r\n\r\n      for (let i = 0; i < this.selectedRoleList.length; i++) {\r\n        roleIds.push(this.selectedRoleList[i].roleId);\r\n      }\r\n      this.$confirm(\"确认删除该角色吗?\", \"删除角色\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\"\r\n      }).then(() => {\r\n        this.$deleteAxios(`${this.$axios.server}/springmvc/role/deleteRole`, {\r\n          roleIds: roleIds.join()\r\n        })\r\n          .then(function(data) {\r\n            if (data.status) {\r\n              _this.$notify({\r\n                title: \"删除角色成功\",\r\n                type: \"success\"\r\n              });\r\n              _this.resetForm();\r\n            } else {\r\n              this.$notify({\r\n                title: data.errorMsg,\r\n                type: \"success\"\r\n              });\r\n            }\r\n          })\r\n          .catch(function(err) {\r\n            _this.$notify({\r\n              title: err,\r\n              type: \"error\"\r\n            });\r\n          });\r\n      });\r\n    },\r\n\r\n    showEditRoleModal: function() {\r\n      this.editRoleVisible = true;\r\n      this.editForm.name = this.selectedRoleList[0].roleName;\r\n      this.editForm.remark = this.selectedRoleList[0].remark;\r\n    },\r\n    //编辑\r\n    surEditRole: function() {\r\n      this.$refs.editForm.validate(valid => {\r\n        if (valid) {\r\n          this.addLoading = true;\r\n          let params = {};\r\n          params.roleId = this.selectedRoleList[0].roleId;\r\n          params.roleName = this.editForm.name;\r\n          params.remark = this.editForm.remark;\r\n          this.$putAxios(\r\n            `${this.$axios.server}/springmvc/role/editRole`,\r\n            params\r\n          ).then(res => {\r\n            this.addLoading = false;\r\n            if (res.status) {\r\n              this.$notify({\r\n                title: \"修改角色成功\",\r\n                type: \"success\"\r\n              });\r\n         \r\n              this.editRoleVisible = false;\r\n              this.getRoleList();\r\n            } else {\r\n              this.$notify({\r\n                title: \"修改角色失败\",\r\n                type: \"error\"\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n\r\n    //新增角色\r\n    surAddRole: function() {\r\n      var _this = this;\r\n      this.$refs.addForm.validate(valid => {\r\n        if (valid) {\r\n          this.addLoading = true;\r\n          let params = {};\r\n\r\n          params.roleName = this.addForm.name;\r\n          params.remark = this.addForm.remark;\r\n          this.$post(\r\n            `${this.$axios.server}/springmvc/role/addRole`,\r\n            params\r\n          ).then(res => {\r\n            _this.addLoading = false;\r\n            if (res.status) {\r\n              this.$notify({\r\n                title: \"创建角色成功\",\r\n                type: \"success\"\r\n              });\r\n              this.$refs[\"addForm\"].resetFields();\r\n              this.addRoleVisible = false;\r\n              this.resetForm();\r\n            } else {\r\n              this.$notify({\r\n                title: \"创建角色失败\",\r\n                message: res.errorMsg,\r\n                type: \"error\"\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n\r\n    selectRole: function(sels) {\r\n      this.selectedRoleList = sels||{};\r\n\r\n      if (sels.length > 1) {\r\n        this.isDubble = false;\r\n        this.isSingle = true;\r\n      } else if (sels.length === 1) {\r\n        this.isDubble = false;\r\n        this.isSingle = false;\r\n      } else {\r\n        this.isDubble = true;\r\n        this.isSingle = true;\r\n      }\r\n    },\r\n\r\n    getRoleMenu: function() {\r\n      var _this = this;\r\n      let menus = [],\r\n        menuObj = {},\r\n        menuParent = {},\r\n        result = [];\r\n      _this.checekdTreeNodes = [];\r\n      _this.checkedMenu = [];\r\n      this.$get(`${this.$axios.server}/springmvc/role/listAllMenus.do`, {\r\n        roleId: _this.selectedRoleList[0].roleId\r\n      }).then(res => {\r\n        if (res.status) {\r\n          result = (res && res.content && res.content.treeDatas) || [];\r\n          if (result.length) {         \r\n              menus = result.map(function(item, idx) {\r\n                item.pId && (menuParent[item.pId] = 1);\r\n                item.id = item.id\r\n                  ? item.id\r\n                  : item.accCode\r\n                  ? item.pId + item.accCode\r\n                  : item.pId + idx;\r\n                item.pid = item.pId;\r\n                if (item.checked === \"true\" && item.accCode) {\r\n                  _this.checekdTreeNodes.push(item);\r\n                  _this.checkedMenu.push(item.id);\r\n                }\r\n                return item;\r\n              });\r\n\r\n              menus.map(i=>{\r\n                !i.pid&&(i.pid='');\r\n                let p=menuObj[i.pid];\r\n                if(!p){\r\n                  p=menuObj[i.pid]={\r\n                    id:i.pid,\r\n                    disabled:true,\r\n                    children:[]\r\n                  }\r\n                }else{\r\n                  !p.children&&(p.children=[]);\r\n                  p.disabled =true;\r\n                }\r\n                let item=menuObj[i.id]||{id:i.id};\r\n                item.name = i.name;\r\n                item.pid = i.pid;\r\n                item.checked = i.checked;\r\n                i.accCode&&(item.accCode = i.accCode);\r\n                item.type = i.type;\r\n                i.open&&(item.open =i.open);\r\n                menuObj[i.id]=item;\r\n                p.children.push(item);\r\n              });\r\n\r\n              Object.keys(menuObj)\r\n                  .filter(e=>!menuObj[e].children)\r\n                  .map(e=>delete menuObj[e]);\r\n\r\n               _this.roleMenuTree = menuObj[''].children;\r\n          }\r\n        }\r\n      });\r\n    },\r\n    selectedMenuTree: function(data, ischeck, target) {\r\n      var oldCheckedTree = this.checekdTreeNodes,\r\n          flag = true;\r\n      \r\n      if(data.accCode){\r\n      if (ischeck) {\r\n        for (let i = 0; i < oldCheckedTree.length; i++) {\r\n        var item = oldCheckedTree[i];\r\n        if (item.pid === data.pid) {\r\n          this.checekdTreeNodes.splice(i, 1, data);\r\n          this.$refs.roleMenuTree.setCheckedNodes(this.checekdTreeNodes);\r\n          flag = false;\r\n        }\r\n        }\r\n        if(flag){\r\n          this.checekdTreeNodes = this.$refs.roleMenuTree.getCheckedNodes();\r\n        }\r\n\r\n      }else{\r\n          this.checekdTreeNodes = this.$refs.roleMenuTree.getCheckedNodes();\r\n      }\r\n\t  }\r\n\r\n    },\r\n    showLevelModal: function() {\r\n      this.getRoleMenu();\r\n      this.levelModalVisible = true;\r\n    },\r\n\r\n    //关联权限\r\n    associateLevel: function() {\r\n\t  var checkedNodes = this.$refs.roleMenuTree.getCheckedNodes(),\r\n\t  \t  parentNodes = this.$refs.roleMenuTree.getHalfCheckedNodes(),\r\n\t\t  accessIds = [],\r\n\t\t  parentObj = {};\r\n\r\n      for (let i = 0; i < checkedNodes.length; i++) {\r\n        var item = checkedNodes[i],\r\n          str = item.pid + \"=\" + item.accCode;\r\n\t\t\r\n\t\tparentObj[item.pid]=1;\r\n        accessIds.push(str);\r\n\t  }\r\n      for (let i = 0; i < parentNodes.length; i++) {\r\n        var item = parentNodes[i],\r\n          str = item.id + \"=PARENT_NODE\";\r\n\r\n\t\tif(!parentObj[item.id]){\r\n\t\t\taccessIds.push(str);\r\n\t\t}\r\n        \r\n\t  }\r\n\r\n      this.$putAxios(\r\n        `${this.$axios.server}/springmvc/role/relevanceAccess`,\r\n        {\r\n          roleId: this.selectedRoleList[0].roleId,\r\n          accessIds: accessIds.join()\r\n        }\r\n      ).then(res => {\r\n        if (res.status) {\r\n          this.$notify({\r\n            title: \"关联权限成功\",\r\n            type: \"success\"\r\n          });\r\n          this.levelModalVisible = false;\r\n        } else {\r\n          this.$notify({\r\n            title: \"关联权限失败\",\r\n            message: res.errorMsg,\r\n            type: \"error\"\r\n          });\r\n        }\r\n      });\r\n    },\r\n\r\n    formatTime: function(data) {\r\n      var date = data && new Date(data);\r\n\r\n      if (data && date) {\r\n        return (\r\n          date.getFullYear() +\r\n          \"-\" +\r\n          (date.getMonth() + 1 > 9\r\n            ? date.getMonth() + 1\r\n            : \"0\" + (date.getMonth() + 1)) +\r\n          \"-\" +\r\n          (date.getDate() > 9 ? date.getDate() : \"0\" + date.getDate()) +\r\n          \" \" +\r\n          (date.getHours() > 9 ? date.getHours() : \"0\" + date.getHours()) +\r\n          \":\" +\r\n          (date.getMinutes() > 9\r\n            ? date.getMinutes()\r\n            : \"0\" + date.getMinutes()) +\r\n          \":\" +\r\n          (date.getSeconds() > 9 ? date.getSeconds() : \"0\" + date.getSeconds())\r\n        );\r\n      } else {\r\n        return \"\";\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getRoleList();\r\n    console.log(\"刷新表格页面,参数\", this.params);\r\n  },\r\n  resume() {\r\n    console.log(\"表格页面resume\");\r\n  },\r\n  pause() {\r\n    console.log(\"表格页面pause\");\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.aweb-table-toolbar {\r\n  padding: 12px;\r\n  text-align: left;\r\n}\r\n</style>"],"sourceRoot":"src/views/global"}]}